---
title: "ë‚™ê´€ì  ì—…ë°ì´íŠ¸ì™€ React19 useOptimistic"
description: ë‚™ê´€ì  ì—…ë°ì´íŠ¸ì™€ React 19ì— ìƒˆë¡­ê²Œ ì¶”ê°€ëœ useOptimistic í›…ì— ëŒ€í•´ì„œ ì•Œì•„ë´…ë‹ˆë‹¤.
date: 2025-03-03 05:00:00
toc: true
tags:
  - react
  - optimistic updates
---

í•­í•´ í”„ë¡ íŠ¸ì—”ë“œ 3ê¸° ë™ê¸°ë“¤ê³¼ React 19ì— ëŒ€í•´ í•™ìŠµí•˜ëŠ” ê¸°ìˆ  ìŠ¤í„°ë””ë¥¼ ì§„í–‰í–ˆë‹¤.<br />
í‰ì†Œ íšŒì‚¬ì—ì„œëŠ” Vueë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— Reactì˜ ìƒˆë¡œìš´ ê¸°ëŠ¥ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ê³  ì‹¶ì—ˆê³ , ì´ë¥¼ í†µí•´ì„œ ì—¬ëŸ¬ ì¸ì‚¬ì´íŠ¸ë¥¼ ì–»ê¸° ìœ„í•´ì„œ ê³µì‹ ë¬¸ì„œë¥¼ ì½ê³ , ìƒˆë¡­ê²Œ ë‚˜ì˜¨ ê¸°ìˆ ì— ëŒ€í•´ì„œ í•™ìŠµí•´ë³´ëŠ” ì‹œê°„ì„ ê°€ì¡Œë‹¤.<br />
ì—¬ëŸ¬ í›…ì´ ìƒˆë¡œ ì¶”ê°€ëì§€ë§Œ ê·¸ ì¤‘ì—ì„œë„ `useOptimistic`ì— ëŒ€í•´ì„œ ì¡°ê¸ˆë” ìì„¸í•˜ê²Œ ì•Œì•„ë´¤ë‹¤.

## ë‚™ê´€ì  ì—…ë°ì´íŠ¸(Optimistic Updates)ë€?

**"ë‚™ê´€ì  ì—…ë°ì´íŠ¸ë€ ì„œë²„ì— ìš”ì²­ì„ ë³´ë‚´ê¸° ì „ì— UIë¥¼ ë¨¼ì € ì—…ë°ì´íŠ¸í•˜ëŠ” ê²ƒì„ ë§í•œë‹¤.
ìš”ì²­ì´ í•­ìƒ ì„±ê³µí•œë‹¤ê³  ê°€ì •í•˜ê³ , ì‚¬ìš©ìì˜ ì•¡ì…˜ì— ë”°ë¥¸ ê²°ê³¼ë¥¼ ì¦‰ì‹œ ë³´ì—¬ì£¼ê¸° ë•Œë¬¸ì— ì‚¬ìš©ì ê²½í—˜ì„ í–¥ìƒí•  ìˆ˜ ìˆë‹¤."**<br />
ë¬¼ë¡ , ëª¨ë“  ìš”ì²­ì´ í•­ìƒ ì„±ê³µí•˜ëŠ” ê²ƒì€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— ìš”ì²­ì´ ì‹¤íŒ¨í–ˆì„ ë•Œ ì´ì „ ìƒíƒœë¡œ ë˜ëŒë¦¬ê³  ì‚¬ìš©ìì—ê²Œ ì ì ˆí•œ í”¼ë“œë°±ì„ ì œê³µí•˜ëŠ” ë¡œì§ì´ ë°˜ë“œì‹œ í•„ìš”í•˜ë‹¤!

ë‚™ê´€ì  ì—…ë°ì´íŠ¸ì˜ í•µì‹¬ ì•„ì´ë””ì–´ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

1. ì‚¬ìš©ì ì•¡ì…˜(ex ì¢‹ì•„ìš” ë²„íŠ¼ í´ë¦­)
2. ë²„íŠ¼ í´ë¦­ê³¼ ë™ì‹œì— ì‚¬ìš©ìì˜ í™”ë©´ì„ ê¸°ëŒ€í•˜ëŠ” ê²°ê³¼ë¡œ ì¦‰ì‹œ ì—…ë°ì´íŠ¸
3. ì„œë²„ì— ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì„ ë³´ëƒ„
4. ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì´ ì™„ë£Œë˜ë©´ ì„œë²„ì˜ ì‘ë‹µìœ¼ë¡œ í™”ë©´ì„ ì—…ë°ì´íŠ¸
5. ìš”ì²­ì´ ì‹¤íŒ¨í•  ê²½ìš° ì´ì „ ìƒíƒœë¡œ ë³µì›í•˜ê³ , ì‚¬ìš©ìì—ê²Œ ìš”ì²­ì´ ì‹¤íŒ¨í–ˆë‹¤ëŠ” í”¼ë“œë°±ì„ ì œê³µ

---

### useStateë¡œ ë‚™ê´€ì  ì—…ë°ì´íŠ¸ë¥¼ êµ¬í˜„í•˜ëŠ” ë°©ë²•

`useState`ë§Œ ì‚¬ìš©í•´ë„ ë‚™ê´€ì  ì—…ë°ì´íŠ¸ë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.<br />
í˜„ì¬ ì¢‹ì•„ìš” ìƒíƒœì™€ ê°œìˆ˜ë¥¼ ë³´ì—¬ì£¼ê³ , ì‚¬ìš©ìê°€ ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ ì¢‹ì•„ìš” ì¶”ê°€/ì œê±° apië¥¼ ìš”ì²­í•˜ëŠ” ê°„ë‹¨í•œ ì»´í¬ë„ŒíŠ¸ë¥¼ êµ¬í˜„í–ˆë‹¤.

```tsx showLineNumbers
// LikeButton.tsx
import { startTransition } from 'react'
import { Heart } from "lucide-react"
import { addLike, removeLike } from "@/app/services"

interface State {
  isLike: boolean
  count: number
}

function LikeButton() {
  const [state, setState] = useState<State>({ 
    isLike: false,
    count: 0
  })

  const handleClick = async () => {
    const currentState = state
    const nextState = {
      isLike: !currentState.isLike,
      count: currentState.isLike ? currentState.count - 1 : currentState.count + 1
    }

    // ë‚™ê´€ì  ì—…ë°ì´íŠ¸
    setState(nextState)

    try {
      const response = nextState.isLike ? await addLike() : await removeLike()
      // ì„œë²„ ì‘ë‹µ ê²°ê³¼ë¡œ UIë¥¼ ì—…ë°ì´íŠ¸
      setState(response)
      setError('')
    } catch (error) {
      if (error instanceof Error) {
        // ìš”ì²­ì— ì‹¤íŒ¨í–ˆì„ ê²½ìš° ì´ì „ ìƒíƒœë¡œ ë³µì›
        setState(currentState)
        setError(error.message)
      }
    }
  }

  return (
    <button onClick={handleClick}>
      {state.isLike ? 'â¤ï¸' : 'ğŸ¤'}
      <span>{state.count}</span>
    </button>
  )
}
```

- api ìš”ì²­ì„ ë³´ë‚´ê¸° ì „ í˜„ì¬ ìƒíƒœë¥¼ ì €ì¥í•˜ê¸° ìœ„í•´ `currentState` ë³€ìˆ˜ë¥¼ ì„ ì–¸í•œë‹¤.
- `setState`ë¥¼ í˜¸ì¶œí•´ì„œ ìš”ì²­ì„ ë³´ë‚´ê¸° ì „ì— ë¨¼ì € UIë¥¼ ì—…ë°ì´íŠ¸í•œë‹¤.
  - ì¢‹ì•„ìš” ìƒíƒœê°€ ì•„ë‹ ê²½ìš°, ì¢‹ì•„ìš” ìƒíƒœë¡œ ë³€ê²½í•˜ê³  ê°œìˆ˜ë¥¼ 1 ì¦ê°€
  - ì¢‹ì•„ìš” ìƒíƒœì¼ ê²½ìš°, ì¢‹ì•„ìš”ë¥¼ í•´ì œí•˜ê³  ê°œìˆ˜ë¥¼ 1 ê°ì†Œ
- ìš”ì²­ì´ ì„±ê³µí–ˆì„ ê²½ìš° ì„œë²„ì˜ ì‘ë‹µìœ¼ë¡œ UIë¥¼ ë‹¤ì‹œ ì—…ë°ì´íŠ¸í•œë‹¤.
- ìš”ì²­ì´ ì‹¤íŒ¨í–ˆì„ ê²½ìš°ì—ëŠ” `currentState`ë¥¼ ì´ìš©í•´ì„œ ë‹¤ì‹œ ì´ì „ ìƒíƒœë¥¼ ë³µì›í•œë‹¤.

---

## React19 useOptimistic í›…

React 19ì—ì„œ ë‚™ê´€ì  ì—…ë°ì´íŠ¸ë¥¼ ì‰½ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆëŠ” `useOptimistic` í›…ì´ ì¶”ê°€ë˜ì—ˆë‹¤.<br />
ê³µì‹ ë¬¸ì„œì—ì„œëŠ” `useOptimistic` í›…ì— ëŒ€í•´ì„œ ë‹¤ìŒê³¼ ê°™ì´ ì„¤ëª…í•˜ê³  ìˆë‹¤.

> useOptimisticì€ React Hookìœ¼ë¡œ, ë¹„ë™ê¸° ì‘ì—…ì´ ì§„í–‰ ì¤‘ì¼ ë•Œ ë‹¤ë¥¸ ìƒíƒœë¥¼ ë³´ì—¬ì¤„ ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤.

### useOptimistic í›…ì„ ì´ìš©í•œ ë°©ë²•

```tsx showLineNumbers
// LikeButton.tsx
import { startTransition } from 'react'
import { Heart } from "lucide-react"
import { addLike, removeLike } from "@/app/services"

interface State {
  isLike: boolean
  count: number
}

type Value = State['isLike']

function LikeButton() {
  const [state, setState] = useState<State>({ 
    isLike: false,
    count: 0
  })

  const [optimisticState, toggleOptimisticIsLike] = useOptimistic<State, Value>(
  // useOptimistic í›…ì˜ ì´ˆê¸° ìƒíƒœ
  state,
  // updateFnì€ ë™ì¼
  (currentState: State, optimisticValue: Value): State => {
    return {
      isLike: optimisticValue,
      count: optimisticValue ? currentState.count + 1 : currentState.count - 1
    }
  })

  const handleClick = () => {
    startTransition(async () => {
      const nextIsLike = !optimisticState.isLike

      // ë‚™ê´€ì  ì—…ë°ì´íŠ¸
      toggleOptimisticIsLike(nextIsLike)

      try {
        const response = nextIsLike ? await addLike() : await removeLike()

        // ì„œë²„ ì‘ë‹µ ê²°ê³¼ë¡œ UIë¥¼ ì—…ë°ì´íŠ¸
        setState(response)
        setError('')
      } catch (error) {
        if (error instanceof Error) {
          setError(error.message)
        }
      }
    })
  }

  return (
    <button onClick={handleClick}>
      {
        optimisticState.isLike ? 
        <Heart color="#d04e4e" fill="#d04e4e" size={80} /> :
        <Heart color="#d04e4e" size={80} />
      }
      <span>{optimisticState.count}</span>
    </button>
  )
}
```

ì½”ë“œì˜ ë™ì‘ì„ ì‚´í´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

### useOptimistic í›… ì„ ì–¸

- `useOptimistic`ì„ ë‹¨ë…ìœ¼ë¡œ ì‚¬ìš©í•  ê²½ìš° ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ ë  ë•Œë§ˆë‹¤ ì´ˆê¸° ìƒíƒœë¥¼ ë³€ê²½í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ë‚™ê´€ì  ì—…ë°ì´íŠ¸ê°€ ì ìš©ëœ í›„ í•­ìƒ ì´ˆê¸° ìƒíƒœë¡œ ë˜ëŒì•„ê°„ë‹¤.
- ì¦‰, í›…ì˜ ì´ˆê¸° ìƒíƒœë¥¼ ì„œë²„ ìƒíƒœì™€ ë™ê¸°í™”í•˜ëŠ” ë¡œì§ì´ í•„ìš”í•˜ë‹¤. 

ì´ë²ˆ ì˜ˆì œì—ì„œëŠ” `useState`ê°€ ë°˜í™˜í•œ `state`ë¥¼ `useOptimistic` í›…ì˜ ì´ˆê¸° ìƒíƒœë¡œ ì‚¬ìš©í•˜ë„ë¡ êµ¬í˜„í–ˆë‹¤.
`setState`ê°€ í˜¸ì¶œë˜ì–´ ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ë  ë•Œ ë§ˆë‹¤ `useOptimistic`ì´ ìƒˆë¡œìš´ ì´ˆê¸° ìƒíƒœì™€ í•¨ê»˜ í˜¸ì¶œëœë‹¤.


```tsx showLineNumbers
const [state, setState] = useState<State>({ 
  isLike: false,
  count: 0
})

const [optimisticState, toggleOptimisticIsLike] = useOptimistic<State, Value>(
  // useOptimistic í›…ì˜ ì´ˆê¸° ìƒíƒœ
  state,
  // updateFnì€ ë™ì¼
  (currentState: State, optimisticValue: Value): State => {
  return {
    isLike: optimisticValue,
    count: optimisticValue ? currentState.count + 1 : currentState.count - 1
  }
})
```

`useOptimistic` í›…ì˜ ë§¤ê°œë³€ìˆ˜

- state
  - í›…ì˜ ì´ˆê¸° ìƒíƒœë¥¼ ì§€ì •í•˜ëŠ” ê°’ì´ë‹¤.
- updateFn
  - `optimisticState`(ë‚™ê´€ì ì¸ ìƒíƒœ)ë¥¼ ê³„ì‚°í•˜ì—¬ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ì´ë‹¤.
  - ì²« ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜ëŠ” í˜„ì¬ ìƒíƒœ, ë‘ ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜ëŠ” `toggleOptimisticIsLike` í•¨ìˆ˜ì˜ ì¸ìë¡œ ì „ë‹¬ëœ ê°’ì´ë‹¤.
  - `toggleOptimisticIsLike` í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ë©´ ìƒˆë¡œìš´ ìƒíƒœë¥¼ ê³„ì‚°í•˜ì—¬ ë°˜í™˜í•œë‹¤.

`useOptimistic` í›…ì˜ ë¦¬í„´ ê°’

- optimisticState
  - ë¹„ë™ê¸° ì‘ì—…ì´ ì§„í–‰ ì¤‘ì¸ ë™ì•ˆì— ì‚¬ìš©ìì—ê²Œ ë³´ì—¬ì¤„ ë‚™ê´€ì ì¸ ìƒíƒœì´ë‹¤.
  - ë¹„ë™ê¸° ì‘ì—…ì´ ì§„í–‰ ì¤‘ì¼ ê²½ìš° `updateFn` í•¨ìˆ˜ê°€ ë°˜í™˜í•œ ê°’ê³¼ ë™ì¼í•œ ê°’ì„ ê°€ì§„ë‹¤.
  - ë¹„ë™ê¸° ì‘ì—…ì´ ì§„í–‰ ì¤‘ì´ì§€ ì•Šì„ ê²½ìš° ì´ˆê¸° `state`ì™€ ë™ì¼í•œ ê°’(stateê°€ ê°ì²´ì¼ ê²½ìš° ë™ì¼í•œ ì°¸ì¡°)ì„ ê°€ì§„ë‹¤.
- toggleOptimisticIsLike
  - `toggleOptimisticIsLike` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´ `updateFn`ì´ í˜¸ì¶œë˜ì–´ `optimisticState`ê°€ ì—…ë°ì´íŠ¸ëœë‹¤.
  - í˜¸ì¶œ ì‹œ ì „ë‹¬ ë°›ì€ ì¸ìê°€ `updateFn`ì˜ ë‘ ë²ˆì§¸ ì¸ìë¡œ ì „ë‹¬ëœë‹¤.

---

### ì¢‹ì•„ìš” ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ êµ¬í˜„
```tsx showLineNumbers
const handleClick = () => {
  startTransition(async () => {
    const nextIsLike = !optimisticState.isLike

    // ğŸ’¡ ë‚™ê´€ì  ì—…ë°ì´íŠ¸
    toggleOptimisticIsLike(nextIsLike)

    try {
      const response = nextIsLike ? await addLike() : await removeLike()

      // ì„œë²„ ì‘ë‹µ ê²°ê³¼ë¡œ UIë¥¼ ì—…ë°ì´íŠ¸
      setState(response)
      setError('')
    } catch (error) {
      if (error instanceof Error) {
        setError(error.message)
      }
    }
  })
}
```
- `startTransition` í•¨ìˆ˜ì˜ ì½œë°± í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ `toggleOptimisticIsLike` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œë‹¤.
- `toggleOptimisticIsLike`ê°€ í˜¸ì¶œë˜ë©´ `updateFn`ì´ ì‹¤í–‰ë˜ì–´ `optimisticState`ê°€ ì—…ë°ì´íŠ¸ëœë‹¤.
- `optimisticState`ê°€ ë³€ê²½ë˜ë©´, UIê°€ ë‚™ê´€ì ì¸ ìƒíƒœë¡œ ì—…ë°ì´íŠ¸ëœë‹¤.
- `addLike`, `removeLike` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ apië¥¼ ìš”ì²­í•œë‹¤.
- ìš”ì²­ì— ì„±ê³µí•  ê²½ìš°
  - ì„œë²„ì˜ ì‘ë‹µìœ¼ë¡œ `setState`ë¥¼ í˜¸ì¶œí•˜ê³ , ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ ëœë‹¤.
  - `useOptimistic`ì´ ìƒˆë¡œìš´ ì´ˆê¸° ìƒíƒœ(state)ì™€ í•¨ê»˜ í˜¸ì¶œë˜ì–´ ë‚™ê´€ì ì¸ ìƒíƒœë¡œ ì—…ë°ì´íŠ¸ëœ í™”ë©´ì´ ìœ ì§€ëœë‹¤.
- ìš”ì²­ì— ì‹¤íŒ¨í•  ê²½ìš°
  - `setError`ê°€ í˜¸ì¶œë˜ì–´ ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ëœë‹¤.
  - `useOptimistic`ì˜ ì´ˆê¸° ìƒíƒœê°€ ë³€ê²½ë˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— `optimisticState`ê°€ ë‹¤ì‹œ ì´ˆê¸° ìƒíƒœë¡œ ë˜ëŒì•„ê°€ê³ , ì‚¬ìš©ì ì•¡ì…˜ ì´ì „ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°„ë‹¤.

---

#### âœ” `useOptimistic` í›…ì„ ì‚¬ìš©í•  ë•Œ `startTransition`ê³¼ í•¨ê»˜ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ì´ìœ 

`startTransition`ì˜ ì¸ìë¡œ ì „ë‹¬ë˜ëŠ” ì½œë°± í•¨ìˆ˜ë¥¼ ì•¡ì…˜ì´ë¼ê³  ë¶€ë¥´ëŠ”ë°, `useOptimistic`ì„ ì´ìš©í•´ì„œ ë‚™ê´€ì ì¸ ì—…ë°ì´íŠ¸ë¥¼ ì ìš©í•˜ë ¤ë©´ `startTransition`ì´ë‚˜ React form action ì•ˆì—ì„œ ì‚¬ìš©í•´ì•¼ í•œë‹¤.

-> ê·¸ë ‡ì§€ ì•Šì„ ê²½ìš° ë‹¤ìŒê³¼ ê°™ì€ ì—ëŸ¬ ë©”ì‹œì§€ê°€ ì¶œë ¥ëœë‹¤.
```text
An optimistic state update occurred outside a transition or action. 
To fix, move the update to an action, or wrap with startTransition.
```

#### âœ” `startTransition`ì„ ì‚¬ìš©í•˜ëŠ” ë‘ ê°€ì§€ ë°©ë²•

```jsx
// 1. react íŒ¨í‚¤ì§€ì—ì„œ import
import { startTransition } from 'react'
```

```jsx
// 2. useTransition í›…ê³¼ í•¨ê»˜ ì‚¬ìš©
const [isPending, startTransition] = useTransition()
```
- ë¡œë”© ìƒíƒœë¥¼ ì¶”ê°€ë¡œ ê´€ë¦¬í•´ì•¼ í•  ê²½ìš° useTransition í›…ì„ ìœ ìš©í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- `startTransition`ì˜ ì¸ìë¡œ ì „ë‹¬ëœ ì•¡ì…˜ì´ ì‹¤í–‰ ì¤‘ì¸ ë™ì•ˆ `isPending`ì€ true ê°’ì„ ìœ ì§€í•œë‹¤.

---

### ì»´í¬ë„ŒíŠ¸ UI êµ¬í˜„

```tsx showLineNumbers
return (
  <button onClick={handleClick}>
    {
      optimisticState.isLike ? 
      <Heart color="#d04e4e" fill="#d04e4e" size={80} /> :
      <Heart color="#d04e4e" size={80} />
    }
    <span>{optimisticState.count}</span>
  </button>
)
```
- `optimisticState`ëŠ” ì•¡ì…˜ì´ ì‹¤í–‰ ì¤‘ì¸ ë™ì•ˆ `updateFn`ì´ ë°˜í™˜í•œ ê°’ì„ ìœ ì§€í•˜ì—¬ ì‚¬ìš©ìì—ê²Œ ë‚™ê´€ì  ìƒíƒœë¥¼ ë³´ì—¬ì¤€ë‹¤.

---

### API ì‘ë‹µì— ë”°ë¥¸ UI ë³€í™”

![](/posts/react-use-optimistic/example-2.gif)*API ìš”ì²­ì— ì„±ê³µí–ˆì„ ê²½ìš°*

![](/posts/react-use-optimistic/example-3.gif)*API ìš”ì²­ì— ì‹¤íŒ¨í–ˆì„ ê²½ìš°*

---

### `props`ë¥¼ ì´ìš©í•˜ì—¬ ì„œë²„ ìƒíƒœì™€ ë™ê¸°í™”í•˜ëŠ” ë°©ë²•

- `LikeButton` ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ `useState`ë¥¼ ì„ ì–¸í•˜ì—¬ ì„œë²„ ìƒíƒœì™€ ë™ê¸°í™”í•˜ëŠ” ë°©ë²•ë³´ë‹¤ ë” ê°„ë‹¨í•˜ë‹¤.
- apië¥¼ í˜¸ì¶œí•˜ëŠ” ë¡œì§ì„ ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì— ìœ„ì„í•˜ê³ , `props`ê°€ ë³€ê²½ë˜ì–´ ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ë  ë•Œ `useOptimistic`ë¥¼ ì´ˆê¸° ìƒíƒœì™€ í•¨ê»˜ ì„ ì–¸í•  ìˆ˜ ìˆë‹¤.

```tsx showLineNumbers
// page.tsx
import { useEffect, useState } from "react"
import LikeButton from "@/app/LikeButton"
import { getLike, addLike, removeLike } from "@/app/services"

interface State {
  isLike: boolean
  count: number
}

export default function Home() {
  const [state, setState] = useState<State>({ 
    isLike: false,
    count: 0
  })

  const [error, setError] = useState('')

  useEffect(() => {
    const fetchData = async () => {
      const response = await getLike()
      setState(response)
    }

    fetchData();
  }, [])

  const toggleAction = async (isLike: boolean) => {
    try {
      const response = isLike ? await addLike() : await removeLike()
      setState(response)
      setError('')
    } catch (error) {
      if (error instanceof Error) {
        setError(error.message)
      }
    }
  }

  return (
    <div>
      <LikeButton 
        count={state.count}
        isLike={state.isLike}
        error={error}
        toggleAction={toggleAction} 
      />
    </div>
  );
}
```

```tsx showLineNumbers
// LikeButton.tsx
interface Props {
  isLike: boolean
  count: number
  error: string
  toggleAction: (isLike: boolean) => Promise<void>
}

export default function LikeButton({ count, isLike, error, toggleAction }: Props) {
  // propsë¥¼ ì´ˆê¸° ìƒíƒœë¡œ ì‚¬ìš©
  const [optimisticState, toggleOptimisticIsLike] = useOptimistic<State, State['isLike']>({
    count,
    isLike
  }, (currentState, optimisticValue) => {
    return {
      isLike: optimisticValue,
      count: optimisticValue ? currentState.count + 1 : currentState.count - 1
    }
  })

  const [isPending, startTransition] = useTransition()

  const handleClick = () => {
    startTransition(async () => {
      const nextIsLike = !optimisticState.isLike

      // ë‚™ê´€ì  ì—…ë°ì´íŠ¸
      toggleOptimisticIsLike(nextIsLike)
      
      await toggleAction(nextIsLike)
    })
  }

  return (
    <button onClick={handleClick}>
      {
        optimisticState.isLike ? 
        <Heart color="#d04e4e" fill="#d04e4e" size={80} /> :
        <Heart color="#d04e4e" size={80} />
      }
      <span>{optimisticState.count}</span>
    </button>
  )
}
```

---

## ìš”ì•½

- ë‚™ê´€ì  ì—…ë°ì´íŠ¸ë€ ë¹„ë™ê¸° ì‘ì—…ì´ ì™„ë£Œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ì§€ ì•Šê³ , ê¸°ëŒ€ë˜ëŠ” ê²°ê³¼ë¥¼ ë¨¼ì € ì‚¬ìš©ìì—ê²Œ ë³´ì—¬ì£¼ëŠ” ê¸°ë²•ì´ë‹¤.
- React 19ì— ì¶”ê°€ëœ useOptimistic í›…ì€ ë‚™ê´€ì  ì—…ë°ì´íŠ¸ë¥¼ ì‰½ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì¤€ë‹¤. í›… ë‚´ë¶€ì—ì„œ ì´ˆê¸° ìƒíƒœë¥¼ ê´€ë¦¬í•˜ê³ , api ìš”ì²­ì´ ì‹¤íŒ¨í•˜ë©´ ìë™ìœ¼ë¡œ ì´ˆê¸° ìƒíƒœë¡œ ë˜ëŒì•„ê°„ë‹¤.
- useOptimisticì€ React Form Action, transitionê³¼ í•¨ê»˜ ì‚¬ìš©í•´ì•¼ í•œë‹¤.

---

ì „ì²´ ì½”ë“œëŠ” [ì €ì¥ì†Œ](https://github.com/kyh196201/react-useOptimistic-example/blob/main/app/LikeButton.tsx)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì˜ëª»ëœ ë‚´ìš©ì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í”¼ë“œë°±ì€ ì–¸ì œë‚˜ í™˜ì˜ì…ë‹ˆë‹¤! ğŸ™‚

---

## ì°¸ê³ 

- https://medium.com/@kyledeguzmanx/what-are-optimistic-updates-483662c3e171
- [https://velog.io/@kimkanu/React-í›…-useOptimistic](https://velog.io/@kimkanu/React-%ED%9B%85-useOptimistic)
- [https://velog.io/@jhjung3/Optimistic-Updates-êµ¬í˜„í•˜ê¸°-with-ë¦¬ì•¡íŠ¸-ì¿¼ë¦¬](https://velog.io/@jhjung3/Optimistic-Updates-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0-with-%EB%A6%AC%EC%95%A1%ED%8A%B8-%EC%BF%BC%EB%A6%AC)